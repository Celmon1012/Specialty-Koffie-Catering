import React from "react";

interface ReviewsProps {
  rating?: number; // between 0 and 5
  count?: number;
  size?: number; // star size in px
  textSize?: string; // tailwind text size class
  className?: string;
  label?: React.ReactNode;
}

export default function Reviews({ rating = 5, count = 0, size = 16, textSize = "text-sm", className = "", label }: ReviewsProps) {
  // keep a stable unique id for clipPath
  const uid = React.useId ? React.useId() : `r${Math.round(Math.random() * 1e6)}`;

  // original SVG viewBox is 86x22; keep aspect ratio and set height to `size`
  const svgHeight = size;
  const svgWidth = Math.round((86 / 22) * svgHeight);

  const fillPercent = Math.max(0, Math.min(100, (rating / 5) * 100));

  return (
    <div className={`flex items-center gap-3 ${className}`}>
      <div
        className={`${textSize} font-medium text-black leading-none`}
        style={{
          fontFamily: "Switzer, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",
          fontWeight: 500,
          fontStyle: 'normal',
          fontSize: '20px',
        }}
      >
        {label ? (
          label
        ) : (
          <span>
            {rating.toFixed(1)} <span className="text-black">({count} reviews)</span>
          </span>
        )}
      </div>

      <div className="relative inline-block" style={{ width: svgWidth, height: svgHeight }} aria-hidden="true">
        <svg
          width={svgWidth}
          height={svgHeight}
          viewBox="0 0 86 22"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          className="block"
          role="img"
          aria-hidden="true"
        >
          {/* background (unfilled) */}
          <g fill="#E5E7EB">
            <path d="M8.022 3.55767C8.16656 3.08658 8.83344 3.08658 8.978 3.55767L10.2999 7.86553C10.3644 8.07551 10.5583 8.21885 10.7779 8.21885H15.114C15.5914 8.21885 15.7973 8.82405 15.4189 9.11515L11.8627 11.8509C11.6974 11.978 11.6284 12.1944 11.6895 12.3938L13.0361 16.782C13.1791 17.2478 12.6394 17.6221 12.2533 17.325L8.80487 14.6722C8.62514 14.534 8.37486 14.534 8.19513 14.6722L4.74673 17.325C4.3606 17.6221 3.82094 17.2478 3.96386 16.782L5.31046 12.3938C5.37164 12.1944 5.30264 11.978 5.13732 11.8509L1.58114 9.11515C1.20274 8.82405 1.40859 8.21885 1.88601 8.21885H6.22205C6.44169 8.21885 6.63562 8.07551 6.70005 7.86553L8.022 3.55767Z" />
            <path d="M25.022 3.55767C25.1666 3.08658 25.8334 3.08658 25.978 3.55767L27.2999 7.86553C27.3644 8.07551 27.5583 8.21885 27.7779 8.21885H32.114C32.5914 8.21885 32.7973 8.82405 32.4189 9.11515L28.8627 11.8509C28.6974 11.978 28.6284 12.1944 28.6895 12.3938L30.0361 16.782C30.1791 17.2478 29.6394 17.6221 29.2533 17.325L25.8049 14.6722C25.6251 14.534 25.3749 14.534 25.1951 14.6722L21.7467 17.325C21.3606 17.6221 20.8209 17.2478 20.9639 16.782L22.3105 12.3938C22.3716 12.1944 22.3026 11.978 22.1373 11.8509L18.5811 9.11515C18.2027 8.82405 18.4086 8.21885 18.886 8.21885H23.2221C23.4417 8.21885 23.6356 8.07551 23.7001 7.86553L25.022 3.55767Z" />
            <path d="M42.5245 3.46353C42.6741 3.00287 43.3259 3.00287 43.4755 3.46353L44.9084 7.87336C44.9753 8.07937 45.1673 8.21885 45.3839 8.21885H50.0207C50.505 8.21885 50.7064 8.83865 50.3146 9.12336L46.5633 11.8488C46.3881 11.9761 46.3148 12.2018 46.3817 12.4078L47.8145 16.8176C47.9642 17.2783 47.437 17.6613 47.0451 17.3766L43.2939 14.6512C43.1186 14.5239 42.8814 14.5239 42.7061 14.6512L38.9549 17.3766C38.563 17.6613 38.0358 17.2783 38.1855 16.8176L39.6183 12.4078C39.6852 12.2018 39.6119 11.9761 39.4367 11.8488L35.6854 9.12336C35.2936 8.83866 35.495 8.21885 35.9793 8.21885H40.6161C40.8327 8.21885 41.0247 8.07937 41.0916 7.87336L42.5245 3.46353Z" />
            <path d="M60.022 3.55767C60.1666 3.08658 60.8334 3.08658 60.978 3.55767L62.2999 7.86553C62.3644 8.07551 62.5583 8.21885 62.7779 8.21885H67.114C67.5914 8.21885 67.7973 8.82405 67.4189 9.11515L63.8627 11.8509C63.6974 11.978 63.6284 12.1944 63.6895 12.3938L65.0361 16.782C65.1791 17.2478 64.6394 17.6221 64.2533 17.325L60.8049 14.6722C60.6251 14.534 60.3749 14.534 60.1951 14.6722L56.7467 17.325C56.3606 17.6221 55.8209 17.2478 55.9639 16.782L57.3105 12.3938C57.3716 12.1944 57.3026 11.978 57.1373 11.8509L53.5811 9.11515C53.2027 8.82405 53.4086 8.21885 53.886 8.21885H58.2221C58.4417 8.21885 58.6356 8.07551 58.7001 7.86553L60.022 3.55767Z" />
            <path d="M77.022 3.55767C77.1666 3.08658 77.8334 3.08658 77.978 3.55767L79.2999 7.86553C79.3644 8.07551 79.5583 8.21885 79.7779 8.21885H84.114C84.5914 8.21885 84.7973 8.82405 84.4189 9.11515L80.8627 11.8509C80.6974 11.978 80.6284 12.1944 80.6895 12.3938L82.0361 16.782C82.1791 17.2478 81.6394 17.6221 81.2533 17.325L77.8049 14.6722C77.6251 14.534 77.3749 14.534 77.1951 14.6722L73.7467 17.325C73.3606 17.6221 72.8209 17.2478 72.9639 16.782L74.3105 12.3938C74.3716 12.1944 74.3026 11.978 74.1373 11.8509L70.5811 9.11515C70.2027 8.82405 70.4086 8.21885 70.886 8.21885H75.2221C75.4417 8.21885 75.6356 8.07551 75.7001 7.86553L77.022 3.55767Z" />
          </g>

          {/* filled group clipped by percent */}
          <defs>
            <clipPath id={`clip-${uid}`}>
              <rect x="0" y="0" width={`${fillPercent}%`} height="100%" />
            </clipPath>
          </defs>

          <g clipPath={`url(#clip-${uid})`} fill="#FFC800">
            <path d="M8.022 3.55767C8.16656 3.08658 8.83344 3.08658 8.978 3.55767L10.2999 7.86553C10.3644 8.07551 10.5583 8.21885 10.7779 8.21885H15.114C15.5914 8.21885 15.7973 8.82405 15.4189 9.11515L11.8627 11.8509C11.6974 11.978 11.6284 12.1944 11.6895 12.3938L13.0361 16.782C13.1791 17.2478 12.6394 17.6221 12.2533 17.325L8.80487 14.6722C8.62514 14.534 8.37486 14.534 8.19513 14.6722L4.74673 17.325C4.3606 17.6221 3.82094 17.2478 3.96386 16.782L5.31046 12.3938C5.37164 12.1944 5.30264 11.978 5.13732 11.8509L1.58114 9.11515C1.20274 8.82405 1.40859 8.21885 1.88601 8.21885H6.22205C6.44169 8.21885 6.63562 8.07551 6.70005 7.86553L8.022 3.55767Z" />
            <path d="M25.022 3.55767C25.1666 3.08658 25.8334 3.08658 25.978 3.55767L27.2999 7.86553C27.3644 8.07551 27.5583 8.21885 27.7779 8.21885H32.114C32.5914 8.21885 32.7973 8.82405 32.4189 9.11515L28.8627 11.8509C28.6974 11.978 28.6284 12.1944 28.6895 12.3938L30.0361 16.782C30.1791 17.2478 29.6394 17.6221 29.2533 17.325L25.8049 14.6722C25.6251 14.534 25.3749 14.534 25.1951 14.6722L21.7467 17.325C21.3606 17.6221 20.8209 17.2478 20.9639 16.782L22.3105 12.3938C22.3716 12.1944 22.3026 11.978 22.1373 11.8509L18.5811 9.11515C18.2027 8.82405 18.4086 8.21885 18.886 8.21885H23.2221C23.4417 8.21885 23.6356 8.07551 23.7001 7.86553L25.022 3.55767Z" />
            <path d="M42.5245 3.46353C42.6741 3.00287 43.3259 3.00287 43.4755 3.46353L44.9084 7.87336C44.9753 8.07937 45.1673 8.21885 45.3839 8.21885H50.0207C50.505 8.21885 50.7064 8.83865 50.3146 9.12336L46.5633 11.8488C46.3881 11.9761 46.3148 12.2018 46.3817 12.4078L47.8145 16.8176C47.9642 17.2783 47.437 17.6613 47.0451 17.3766L43.2939 14.6512C43.1186 14.5239 42.8814 14.5239 42.7061 14.6512L38.9549 17.3766C38.563 17.6613 38.0358 17.2783 38.1855 16.8176L39.6183 12.4078C39.6852 12.2018 39.6119 11.9761 39.4367 11.8488L35.6854 9.12336C35.2936 8.83866 35.495 8.21885 35.9793 8.21885H40.6161C40.8327 8.21885 41.0247 8.07937 41.0916 7.87336L42.5245 3.46353Z" />
            <path d="M60.022 3.55767C60.1666 3.08658 60.8334 3.08658 60.978 3.55767L62.2999 7.86553C62.3644 8.07551 62.5583 8.21885 62.7779 8.21885H67.114C67.5914 8.21885 67.7973 8.82405 67.4189 9.11515L63.8627 11.8509C63.6974 11.978 63.6284 12.1944 63.6895 12.3938L65.0361 16.782C65.1791 17.2478 64.6394 17.6221 64.2533 17.325L60.8049 14.6722C60.6251 14.534 60.3749 14.534 60.1951 14.6722L56.7467 17.325C56.3606 17.6221 55.8209 17.2478 55.9639 16.782L57.3105 12.3938C57.3716 12.1944 57.3026 11.978 57.1373 11.8509L53.5811 9.11515C53.2027 8.82405 53.4086 8.21885 53.886 8.21885H58.2221C58.4417 8.21885 58.6356 8.07551 58.7001 7.86553L60.022 3.55767Z" />
            <path d="M77.022 3.55767C77.1666 3.08658 77.8334 3.08658 77.978 3.55767L79.2999 7.86553C79.3644 8.07551 79.5583 8.21885 79.7779 8.21885H84.114C84.5914 8.21885 84.7973 8.82405 84.4189 9.11515L80.8627 11.8509C80.6974 11.978 80.6284 12.1944 80.6895 12.3938L82.0361 16.782C82.1791 17.2478 81.6394 17.6221 81.2533 17.325L77.8049 14.6722C77.6251 14.534 77.3749 14.534 77.1951 14.6722L73.7467 17.325C73.3606 17.6221 72.8209 17.2478 72.9639 16.782L74.3105 12.3938C74.3716 12.1944 74.3026 11.978 74.1373 11.8509L70.5811 9.11515C70.2027 8.82405 70.4086 8.21885 70.886 8.21885H75.2221C75.4417 8.21885 75.6356 8.07551 75.7001 7.86553L77.022 3.55767Z" />
          </g>
        </svg>
      </div>
    </div>
  );
}
